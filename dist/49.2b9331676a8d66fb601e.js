(window.webpackJsonp=window.webpackJsonp||[]).push([[49],{"7TTq":function(e,t,r){"use strict";r.r(t);var i=r("mrSG"),n=r("CcnG"),a=r("ZYCi"),o=r("Ip0R"),l=r("buKM"),d=r("gIcY"),s=r("FTgb"),m=r("67Y/"),c=r("9Z1F"),p=r("XlPw"),u=r("iiAa"),f=r("vblm"),v=r("jRgp"),h=r("X11Z"),g=function(){function e(e,t,r,i,n){this._formService=e,this._formBuilder=t,this._http=r,this._uitilityService=i,this._fileUploadService=n}return e.prototype.createDriverForm=function(){return this._formBuilder.group({name:this._formService.getControl("name"),vehicleType:this._formService.getControl("name"),guestValidity:this._formService.getControl("date"),entrytype:this._formService.getControl("name"),regNo:this._formService.getControl("alphaNumeric"),modal:this._formService.getControl("name"),purposeOfVisit:this._formService.getControl("name"),visitorId:this._formService.getControl("alphaNumeric")})},e.prototype.addDriver=function(e){var t=this,r=e.entryLogId?"put":"post";return this._http[r](v.y,e).pipe(Object(m.a)(function(r){return t._uitilityService.showAlert(f.b[e.userId?"UPDATED":"ADDED"]("Entry log")),r}),Object(c.a)(function(e){return Object(p.a)(e)}))},e.prototype.checkDriverNoUnique=function(e){return this._http.get(v.n,e,!1)},e.prototype.showAlert=function(e){this._uitilityService.showAlert(e)},e.prototype.uploadFiles=function(e){return this._fileUploadService.uploadFiles(e)},e.prototype.getDriverDetail=function(e){return this._http.get(v.A+"/"+e)},e.ctorParameters=function(){return[{type:l.a},{type:d.d},{type:s.a},{type:u.a},{type:h.a}]},e=i.__decorate([Object(n.Injectable)(),i.__metadata("design:paramtypes",[l.a,d.d,s.a,u.a,h.a])],e)}(),y=r("yG5I"),b=r("Oy5v"),_=function(e,t,r){return void 0===t&&(t="image/jpeg,image/png"),void 0===r&&(r=4),new Promise(function(i,n){if(e.target.files&&e.target.files[0]){var a=e.target.files[0];t&&-1===t.split(",").indexOf(a.type)?n({type:1}):r&&r<a.size/1024/1024&&n({size:1});var o=new FileReader;o.readAsDataURL(a),o.onload=function(e){i({file:a,url:e.target.result,name:a.name})}}})},I=r("Gi3i"),V=r("ad02"),w=function(){function e(e,t,r){this._driverAddService=e,this._router=t,this._route=r,this.radioOptions=y.l,this.carType=y.a,this.documentTypes=y.b,this.drinkingStatus=y.c,this.createForm()}return e.prototype.ngOnInit=function(){this.driverId=this._route.snapshot.params.driverId,this.minDate=new Date,this.driverId?this.getDriverDetail():this.validateMobileNo()},e.prototype.validateMobileNo=function(){var e=this;this.driverForm.controls.mobileNo.valueChanges.pipe(Object(I.a)(800),Object(V.a)()).subscribe(function(t){t&&t.length>=3&&e.checkDriverNoUnique(t)})},e.prototype.checkDriverNoUnique=function(e){var t=this;this._driverAddService.checkDriverNoUnique({mobileNo:e}).subscribe(function(e){e&&200==e.statusCode?t.isUniqueMsg=null:e&&400==e.statusCode&&(t.driverForm.controls.mobileNo.setErrors({incorrect:!0}),t.isUniqueMsg="Mobile Number must be unique")})},e.prototype.createForm=function(){this.driverForm=this._driverAddService.createDriverForm()},e.prototype.getDriverDetail=function(){var e=this;this._driverAddService.getDriverDetail(this.driverId).subscribe(function(t){e.driverDetail=t.data,console.log(e.driverDetail),e.patchValue(t.data[0]),e.driverDetail[0].vehicleInfo&&(e.isvehicleId=!0),e.startAt=new Date(e.driverDetail[0].userData.guestValidity)},function(t){e._router.navigate([b.DRIVER])})},e.prototype.patchValue=function(e){e.vehicleId?e.userData.guestValidity?this.formValue={name:e.userData.name,vehicleType:e.vehicleData.vehicleType,guestValidity:new Date(e.userData.guestValidity).toDateString(),entrytype:e.entryType,regNo:e.vehicleData.regNo,modal:e.vehicleData.modal}:this.formValue={name:e.userData.name,vehicleType:e.vehicleData.vehicleType,guestValidity:void 0,entrytype:e.entryType,regNo:e.vehicleData.regNo,modal:e.vehicleData.modal}:(this.vehicleInfoLength=Object.keys(e.vehicleInfo).length,e.userData.guestValidity?this.formValue={name:e.vehicleInfo.name,vehicleType:e.vehicleInfo.vehicleType,guestValidity:new Date(e.userData.guestValidity).toDateString(),entrytype:e.entryType,regNo:e.vehicleInfo.regNo,modal:e.vehicleInfo.modal,purposeOfVisit:e.vehicleInfo.purposeOfVisit,visitorId:e.vehicleInfo.visitorId}:this.formValue={name:e.vehicleInfo.name,vehicleType:e.vehicleInfo.vehicleType,guestValidity:void 0,entrytype:e.entryType,regNo:e.vehicleInfo.regNo,modal:e.vehicleInfo.modal,purposeOfVisit:e.vehicleInfo.purposeOfVisit,visitorId:e.vehicleInfo.visitorId}),this.driverForm.patchValue(this.formValue)},e.prototype.getControl=function(e){return this.driverForm.controls[e]},e.prototype.uploadFiles=function(){return i.__awaiter(this,void 0,void 0,function(){var e;return i.__generator(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this._driverAddService.uploadFiles([this.driverImageFile,this.dlFile,this.leftPalmFile,this.rightPalmFile,this.addressProofFile])];case 1:return[2,t.sent()];case 2:return e=t.sent(),[2,Promise.reject(e)];case 3:return[2]}})})},e.prototype.getFileName=function(e){return Object(y.s)(e)},e.prototype.submitForm=function(){return i.__awaiter(this,void 0,void 0,function(){var e;return i.__generator(this,function(t){return e=i.__assign({},this.driverForm.value),this.driverForm.disable(),this.addDriver(e),[2]})})},e.prototype.addDriver=function(e){var t,r=this;console.log(e),console.log(this.driverDetail),t=this.driverDetail[0].vehicleId?{vehicleData:e,vehicleId:this.driverDetail[0].vehicleId,userId:this.driverDetail[0].userId}:{vehicleInfo:e},this.driverId&&(t.entryLogId=this.driverId),this.driverDetail[0].vehicleId&&(delete t.vehicleData.intime,delete t.vehicleData.entrytype,delete t.vehicleData.regNo),console.log(t),this._driverAddService.addDriver(t).subscribe(function(e){r._router.navigate([b.DRIVER])},function(e){r.driverForm.enable()})},e.prototype.onSelectFile=function(e,t,r){return void 0===r&&(r="image/jpeg,image/png,application/pdf"),i.__awaiter(this,void 0,void 0,function(){var n,a;return i.__generator(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,_(e,r)];case 1:return n=i.sent(),this.handleFileSuccess(n,t),[3,3];case 2:return(a=i.sent()).type?"image/jpeg,image/png,application/pdf"===r?this._driverAddService.showAlert(Object(f.h)("image/jpeg,image/png images and pdf")):this._driverAddService.showAlert(Object(f.h)()):a.size&&this._driverAddService.showAlert(Object(f.i)()),[3,3];case 3:return[2]}})})},e.prototype.handleFileSuccess=function(e,t){switch(t){case this.documentTypes.driverImage:this.driverImage=e.url,this.driverImageFile=e.file,this.driverForm.controls.profilePicture.setValue(e.name);break;case this.documentTypes.fullDl:this.dlUrl=e.url,this.dlFile=e.file,this.driverForm.controls.dl.setValue(e.name);break;case this.documentTypes.leftPalm:this.leftPalmUrl=e.url,this.leftPalmFile=e.file,this.driverForm.controls.leftPalm.setValue(e.name);break;case this.documentTypes.rightPalm:this.rightPalmUrl=e.url,this.rightPalmFile=e.file,this.driverForm.controls.rightPalm.setValue(e.name);break;case this.documentTypes.addressProof:this.addressProof=e.url,this.addressProofFile=e.file,this.driverForm.controls.addressProof.setValue(e.name);break;default:alert("Wrong Type")}},e.ctorParameters=function(){return[{type:g},{type:a.d},{type:a.a}]},e=i.__decorate([Object(n.Component)({selector:"app-entrylog-add",template:r("bFCM"),styles:[r("i0hb")]}),i.__metadata("design:paramtypes",[g,a.d,a.a])],e)}(),x=r("UodH"),D=r("Wf4p"),F=r("jQLj"),T=r("seP3"),C=r("SMsm"),N=r("b716"),S=r("9It4"),A=r("3V+5"),P=r("FpXt"),j=r("IKo7"),O=r("VWX5"),U=r("uGex");r.d(t,"EntryLogAddModule",function(){return k});var k=function(){function e(){}return e=i.__decorate([Object(n.NgModule)({declarations:[w],imports:[o.c,D.m,F.a,U.a,T.c,N.b,S.a,x.a,d.n,A.a,j.a,P.a,C.a,O.c,O.b,a.e.forChild([{path:"",component:w}])],providers:[g]})],e)}()},bFCM:function(e,t){e.exports='<div class="custom_container">\n    <form [formGroup]="driverForm" #form="ngForm" (ngSubmit)="submitForm()">\n        <div class="white_wrapper">\n            <h2 class="heading">Genral Information</h2>\n            <div class="flex_row">\n                <ul class="breadcrumb">\n                    <li>\n                        <a href="javascript:void(0)">Home</a>\n                    </li>\n                    <li>\n                        <a routerLink="/admin/entry-log/list">EntryLog</a>\n                    </li>\n                    <li>\n                        <a href="javascript:void(0)" class="active">{{driverId?\'Edit\':\'Add\'}}</a>\n                    </li>\n                </ul>\n            </div>\n\n            <div class="form_wrapper">\n\n\n                <div class="flex_row">\n                    <div class="flex_col_sm_5">\n                        <div class="form_filed_wrapper">\n                            <mat-form-field appearance="outline" [class.disabled]="driverId && formValue.regNo != undefined">\n                                <mat-label>No. Plate</mat-label>\n                                <input formControlName="regNo" matInput  [readonly]="driverId && formValue.regNo != undefined"/>\n                                <mat-error>{{ getControl("regNo") | validate: "No. Plate" }}\n                                </mat-error>\n                            </mat-form-field>\n                        </div>\n                    </div>\n\n                    \x3c!-- <div class="flex_col_sm_5">\n                        <div class="form_filed_wrapper">\n                            <mat-form-field appearance="outline" [class.disabled]="driverId && formValue.vehicleType != undefined" >\n                                <mat-label>Vehicle Type</mat-label>\n                                <input formControlName="vehicleType" matInput [readonly]="driverId && formValue.vehicleType != undefined"/>\n                                <mat-error>{{ getControl("vehicleType") | validate: "Type" }}\n                                </mat-error>\n                            </mat-form-field>\n                        </div>\n\n                    </div> --\x3e\n\n                    <div class="flex_col_sm_5">\n                        <div class="form_filed_wrapper">\n                            <mat-form-field appearance="outline" [class.disabled]="driverId && formValue.vehicleType != undefined" >\n                                <mat-label name="labelHolder">Vehicle Type</mat-label>\n                                <mat-select name="vehicleType" class="form-control" formControlName="vehicleType" placeholder="Vehicle Type"\n                                    [ngClass]="selected" [disabled]="driverId && formValue.vehicleType != undefined">\n                                  \n                                    <mat-option *ngFor="let type of carType" [value]="type.value">\n                                        {{type.viewValue}}\n                                        \n                                    </mat-option>\n                                </mat-select>\n                                <mat-error>{{getControl(\'vehicleType\')|validate:\'Vehicle Type\'}}\n                                </mat-error>\n                            </mat-form-field>\n                        </div>\n                    </div>\n\n                </div>\n\n                <div class="flex_row">\n                    <div class="flex_col_sm_5">\n\n                        <div class="form_filed_wrapper">\n                            <mat-form-field appearance="outline" [class.disabled]="driverId && (formValue.modal != undefined && formValue.modal != \'\' )">\n                                <mat-label>Model</mat-label>\n                                <input formControlName="modal" matInput [readonly]="driverId && (formValue.modal != undefined && formValue.modal != \'\' )"/>\n                                <mat-error>{{ getControl("modal") | validate: "Modal" }}\n                                </mat-error>\n                            </mat-form-field>\n                        </div>\n                    </div>\n\n                    <div class="flex_col_sm_5">\n                        <div class="form_filed_wrapper">\n                            <mat-form-field appearance="outline" [class.disabled]="driverId && (formValue.name != undefined && formValue.name != \'\' )">\n                                <mat-label>Username</mat-label>\n                                <input formControlName="name" matInput [readonly]="driverId && (formValue.name != undefined && formValue.name != \'\' )" />\n                                <mat-error>{{ getControl("Username") | validate: "Username" }}\n                                </mat-error>\n                            </mat-form-field>\n                        </div>\n                    </div>\n                </div>\n\n                <div class="flex_row" *ngIf="isvehicleId">\n                    <div class="flex_col_sm_5">\n                        <div class="form_filed_wrapper">\n                            <mat-form-field appearance="outline" [class.disabled]="driverId && formValue.visitorId != undefined">\n                                <mat-label>Visitor Id</mat-label>\n                                <input formControlName="visitorId" matInput [readonly]="driverId && formValue.visitorId != undefined" />\n                                <mat-error>{{ getControl("visitorId") | validate: "Visitor ID" }}\n                                </mat-error>\n                            </mat-form-field>\n                        </div>\n                    </div>\n\n                        <div class="flex_col_sm_5">\n                            <div class="form_filed_wrapper">\n                                <mat-form-field appearance="outline" [class.disabled]="driverId && formValue.purposeOfVisit != undefined">\n                                    <mat-label>Purpose of visit</mat-label>\n                                    <input formControlName="purposeOfVisit" matInput [readonly]="driverId && formValue.purposeOfVisit != undefined" />\n                                    <mat-error>{{ getControl("purposeOfVisit") | validate: "Purpose" }}\n                                    </mat-error>\n                                </mat-form-field>\n                            </div>\n                        </div>\n                </div>\n\n                <div class="flex_row">\n                    <div class="flex_col_sm_5" *ngIf="formValue.guestValidity != undefined || vehicleInfoLength == 3">\n                        <div class="form_filed_wrapper">\n                            <mat-form-field appearance="outline">\n                                <mat-label>Valid Till</mat-label>\n\n                                <input matInput readonly formControlName="guestValidity" [value]="driverForm.controls[\'guestValidity\'].value | date:\'medium\'" [min]="minDate" [owlDateTimeTrigger]="dt2" [owlDateTime]="dt2">\n                                <owl-date-time [startAt]="startAt"  [pickerType]="\'both\'" [hour12Timer]="true" #dt2></owl-date-time>\n\n                                \x3c!-- <input formControlName="guestValidity" numberOnly matInput /> --\x3e\n                                \x3c!-- [readonly]="driverId" --\x3e\n                                <mat-error>{{ getControl("guestValidity") | validate: "Valid Till" }}\n                                </mat-error>\n                                <mat-error *ngIf="isUniqueMsg">{{ isUniqueMsg }}</mat-error>\n                            </mat-form-field>\n                        </div>\n                    </div>\n\n                    <div class="flex_col_sm_5">\n                        <div class="form_filed_wrapper">\n                            <mat-form-field appearance="outline" [class.disabled]="driverId && formValue.entrytype != undefined">\n                                <mat-label>Entry Type</mat-label>\n                                <input formControlName="entrytype" matInput [readonly]="driverId && formValue.entrytype != undefined"/>\n                                <mat-error>{{ getControl("entrytype") | validate: "Entry Type" }}\n                                </mat-error>\n                            </mat-form-field>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n\n\n        <div class="white_wrapper">\n            <div class="flex-row">\n                <span class="alert-message">All fields are mandatory</span>\n            </div>\n            <div class="flex-row">\n                <div class="flex-col-sm-10">\n                    <div class="form_filed_wrapper text-center">\n                        <ul class="btn_wrapper">\n                            <li>\n                                <button mat-raised-button type="button" [routerLink]="\'DRIVER\' | absolutePath">\n                                    Cancel\n                                </button>\n                            </li>\n                            <li>\n                                <button mat-raised-button type="submit" color="primary">\n                                    {{ driverId ? "Update" : "Add" }}\n                                </button>\n                            </li>\n                        </ul>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </form>\n</div>'},i0hb:function(e,t){e.exports='@charset "UTF-8";\n.upload_img {\n  width: 150px;\n  height: 150px;\n  overflow: hidden;\n  border: 1px solid #ccc;\n  border-radius: 5px;\n  position: relative;\n  margin: 0 auto;\n}\n.upload_img img {\n  width: 150px;\n  height: 150px;\n  -o-object-fit: cover;\n     object-fit: cover;\n}\n.upload-icon {\n  position: absolute;\n  bottom: 0;\n  left: 50%;\n  -webkit-transform: translateX(-50%);\n          transform: translateX(-50%);\n  background: #606060;\n  padding: 5px 8px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  border-radius: 6px 6px 0 0;\n  color: #fff;\n  cursor: pointer;\n}\nlabel.attach {\n  position: absolute;\n  right: 0px;\n  top: 10px;\n  z-index: 9;\n  cursor: pointer;\n}\n.profile_pic_error {\n  margin-top: 5px;\n  color: #f44336;\n  text-align: center;\n}\n.flex_row {\n  display: flex;\n  margin: 0 -10px;\n  align-items: center;\n}\n.breadcrumb {\n  width: 100%;\n  padding: 5px 15px;\n}\n.breadcrumb li {\n  display: inline-block;\n}\n.breadcrumb li a {\n  color: #006CB8;\n  text-decoration: none;\n  cursor: pointer;\n  font-size: 14px;\n  font-weight: 400;\n  outline: none;\n}\n.breadcrumb li a:before {\n  padding: 0 5px;\n  color: #B7BEC1;\n  content: "/ ";\n}\n.breadcrumb li a:after {\n  content: "/\xa0";\n  padding: 0 2px;\n  color: #A2ABAE;\n}\n.breadcrumb li a.active {\n  color: #262c2d;\n  cursor: default;\n}\n.breadcrumb li a.active:after {\n  display: none;\n}\n.breadcrumb li:first-child a:before, .breadcrumb li:first-child a:after, .breadcrumb li:last-child a:before, .breadcrumb li:last-child a:after {\n  display: none;\n}\n@media (max-width: 1510px) {\n  .flex_col_sm_3 {\n    width: 35%;\n  }\n}\n@media (max-width: 1300px) {\n  .flex_col_sm_3 {\n    width: 33%;\n  }\n}\n.error_size {\n  font-size: 75%;\n}\nbutton.mat-raised-button {\n  box-shadow: none !important;\n  border: 1px solid #0069FF !important;\n  min-width: 104px !important;\n}\n:host ::ng-deep .disabled {\n  opacity: 0.5;\n  cursor: initial;\n}\n:host ::ng-deep .disabled .mat-form-field-flex:hover .mat-form-field-outline-start,\n:host ::ng-deep .disabled .mat-form-field-flex:hover .mat-form-field-outline-end,\n:host ::ng-deep .disabled .mat-form-field-flex:hover .mat-form-field-outline-gap {\n  border-width: 1px !important;\n  border-color: #e0e0e0 !important;\n}'}}]);